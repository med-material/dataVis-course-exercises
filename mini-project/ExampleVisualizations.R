library(tidyverse)
script_path <- dirname(rstudioapi::getActiveDocumentContext()$path)
setwd(script_path)
load(file = "data/aggData.rda")
load(file = "data/datasetReduced.rda")

dfx <- agg_dataNum

agg_dataNum %>%
  filter(
    isYearAgg == FALSE, isAngelKPI == TRUE,
    h_name == "General", nameOfAggr == "dnt_leq_60",
    is.na(subGroup), !is.na(YQ), year == "2019"
  ) %>%
  mutate(condColor = ifelse(is1stDiam > 0, "#7cd461", "#4299f5")) %>%
  ggplot(aes(x = YQ, y = Value, group = 1)) +
  geom_line(aes(x = YQ,y = C_Value), linewidth=3,color = "lightgrey") +
  geom_line(color = "#42aaf5") +
  geom_point(aes(size = data_Pts, color = condColor)) +
  scale_color_identity() +
  theme_minimal() +
  ylab("dnt less or equal to 60, in %.")


agg_dataNum %>%
  filter(
    isYearAgg == FALSE, isAngelKPI == TRUE,
    h_name == "General", nameOfAggr == "dnt_leq_60",
    subGroup == "gender", !is.na(YQ), year == "2019"
  ) %>%
  mutate(gender = factor(subGroupVal)) %>%
  ggplot(aes(x = YQ, y = Value, group = gender, colour = gender)) +
  geom_line(position = position_dodge(.2)) +
  geom_point(aes(size = data_Pts), position = position_dodge(.2)) +
  theme_minimal() +
  ylab("dnt less or equal to 60, in %.")
